<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FIRE HORSE // 2026</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --bg: #0B0B0F;
      --panel: rgba(255,255,255,0.06);
      --stroke: rgba(255,255,255,0.10);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.65);
      --ember: rgba(255, 90, 31, 0.95);
      --gold: rgba(255, 196, 100, 0.95);
    }
    body { background: radial-gradient(1200px 800px at 60% 30%, rgba(255, 90, 31, 0.10), transparent 55%),
                      radial-gradient(900px 700px at 30% 70%, rgba(255, 196, 100, 0.08), transparent 60%),
                      var(--bg); color: var(--text); }
    .glass { background: var(--panel); border: 1px solid var(--stroke); backdrop-filter: blur(10px); }
    .hairline { border-color: var(--stroke); }
    .btn {
      background: linear-gradient(135deg, rgba(255,90,31,0.20), rgba(255,196,100,0.14));
      border: 1px solid rgba(255,255,255,0.14);
      transition: transform 120ms ease, filter 120ms ease;
    }
    .btn:hover { transform: translateY(-1px); filter: brightness(1.06); }
    .btn:active { transform: translateY(0px) scale(0.99); }
    .tab {
      border: 1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.04);
    }
    .tab[data-active="true"]{
      background: linear-gradient(135deg, rgba(255,90,31,0.20), rgba(255,196,100,0.14));
      border-color: rgba(255,255,255,0.18);
      box-shadow: 0 0 0 1px rgba(255,90,31,0.08) inset;
    }
    .resultGlow {
      box-shadow: 0 0 0 1px rgba(255, 90, 31, 0.12) inset,
                  0 25px 80px rgba(255, 90, 31, 0.12);
    }
    .smallcaps { letter-spacing: 0.22em; text-transform: uppercase; }
    /* Subtle heat shimmer on the horse */
    @keyframes shimmer {
      0%, 100% { filter: drop-shadow(0 0 18px rgba(255,90,31,0.16)) drop-shadow(0 0 38px rgba(255,196,100,0.08)); opacity: 0.92; transform: translateY(0px); }
      50% { filter: drop-shadow(0 0 24px rgba(255,90,31,0.22)) drop-shadow(0 0 60px rgba(255,196,100,0.10)); opacity: 1; transform: translateY(-1px); }
    }
    .horse { animation: shimmer 3.4s ease-in-out infinite; }

    /* Gentle card reveal */
    @keyframes reveal {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .reveal { animation: reveal 240ms ease-out both; }

    /* Make canvas not steal clicks */
    #embers { pointer-events: none; }
  </style>
</head>
<body class="min-h-screen">
  <canvas id="embers" class="fixed inset-0 w-full h-full"></canvas>

  <main class="relative mx-auto max-w-6xl px-4 py-10">
    <!-- Header -->
    <header class="flex flex-col gap-6 md:flex-row md:items-end md:justify-between">
      <div class="space-y-2">
        <div class="smallcaps text-xs text-white/70">Lunar New Year</div>
        <h1 class="text-3xl md:text-5xl font-semibold tracking-tight">
          FIRE HORSE <span class="text-white/55">// 2026</span>
        </h1>
        <p class="text-white/70 max-w-xl">
          Pull a fortune, measure your luck, mirror your zodiac, or check your ex ‚Äî
          all under Fire Horse energy.
        </p>
      </div>

      <div class="glass rounded-2xl p-4 md:p-5 w-full md:w-[420px]">
        <div class="flex items-center justify-between">
          <div class="smallcaps text-[11px] text-white/70">Fire Horse Directive</div>
          <button id="newDirectiveBtn" class="text-xs text-white/70 hover:text-white">refresh</button>
        </div>
        <div id="directive" class="mt-2 text-lg font-medium leading-snug">
          Move first. Refine after.
        </div>
        <div class="mt-3 text-xs text-white/55">
        Tip: hit <span class="text-white/70">Share</span> after you get a card screenshot-worthy result.
        </div>
      </div>
    </header>

    <!-- Hero + Controls -->
    <section class="mt-10 grid grid-cols-1 lg:grid-cols-5 gap-6">
      <!-- Horse Hero -->
      <div class="glass rounded-3xl p-6 lg:col-span-2 relative overflow-hidden">
        <div class="mt-4 flex items-center justify-center">
          <!-- Minimal horse silhouette SVG -->
          <svg class="horse w-[260px] md:w-[320px]" viewBox="0 0 260 260" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="Fire Horse silhouette">
            <defs>
              <linearGradient id="emberGrad" x1="40" y1="30" x2="220" y2="230" gradientUnits="userSpaceOnUse">
                <stop stop-color="rgba(255,90,31,0.95)"/>
                <stop offset="1" stop-color="rgba(255,196,100,0.85)"/>
              </linearGradient>
              <filter id="softGlow" x="-30%" y="-30%" width="160%" height="160%">
                <feGaussianBlur stdDeviation="3" result="blur"/>
                <feColorMatrix in="blur" type="matrix"
                  values="1 0 0 0 0
                          0 1 0 0 0
                          0 0 1 0 0
                          0 0 0 0.6 0" result="glow"/>
                <feMerge>
                  <feMergeNode in="glow"/>
                  <feMergeNode in="SourceGraphic"/>
                </feMerge>
              </filter>
            </defs>

            <!-- Ultra-minimal ‚Äúhorse‚Äù path (stylized) -->
            <path filter="url(#softGlow)"
              d="M170 60c-8 10-18 16-30 18-6 1-12 1-18 0 4 7 6 14 6 21 0 10-4 19-10 27 10 3 20 9 28 18 8 9 12 20 12 33v34h-20v-32c0-10-3-18-8-24-7-8-16-12-27-12h-10c-11 0-20 4-27 12-5 6-8 14-8 24v32H58v-34c0-23 8-42 24-56 8-7 17-12 27-14-6-8-10-17-10-27 0-9 3-17 8-24-6-2--17-11-6-6-10-13-12-22 10 1 20-2 28-8 7-6 12-14 13-24 7 6 16 9 26 9 10 0 19-3 27-9 1 10 5 18 11 24 7 7 16 10 25 10z"
              fill="url(#emberGrad)" opacity="0.95"/>

            <!-- Small mane accent -->
            <path d="M147 53c-6 5-12 8-18 9 3-7 4-13 3-19 6 4 11 7 15 10z" fill="rgba(255,255,255,0.10)"/>
          </svg>
        </div>

        <div class="mt-6 flex gap-2">
          <button id="shareBtn" class="btn rounded-2xl px-4 py-2 text-sm font-medium">Share</button>
          <button id="resetBtn" class="rounded-2xl px-4 py-2 text-sm text-white/70 border hairline hover:text-white">Reset</button>
        </div>
        <div id="shareHint" class="mt-2 text-xs text-white/55 hidden">
          Screenshot the result card for maximum drama ‚ú®
        </div>
      </div>

      <!-- App Panel -->
      <div class="lg:col-span-3 space-y-4">
        <!-- Tabs -->
        <div class="grid grid-cols-2 md:grid-cols-5 gap-2">
          <button class="tab rounded-2xl px-3 py-2 text-xs md:text-sm" data-mode="fortune" data-active="true">Fortune</button>
          <button class="tab rounded-2xl px-3 py-2 text-xs md:text-sm" data-mode="luck">Luck</button>
          <button class="tab rounded-2xl px-3 py-2 text-xs md:text-sm" data-mode="zodiac">Zodiac</button>
          <button class="tab rounded-2xl px-3 py-2 text-xs md:text-sm" data-mode="ex">Ex</button>
        </div>

        <!-- Inputs -->
        <div class="glass rounded-3xl p-6">
          <div class="flex items-center justify-between">
          <div>
              <div id="modeTitle" class="text-xl font-semibold">Shake the Fortune</div>
              <div id="modeDesc" class="text-sm text-white/70 mt-1">Click to reveal your Fire Horse fortune card.</div>
            </div>
          </div>

          <div id="inputs" class="mt-5 space-y-4">
            <!-- Dynamic inputs injected here -->
          </div>

          <div class="mt-5 flex gap-2">
            <button id="goBtn" class="btn rounded-2xl px-4 py-2 text-sm font-medium">Reveal</button>
          </div>
        </div>

        <!-- Result -->
        <div id="resultCard" class="glass rounded-3xl p-6 resultGlow hidden">
          <div class="flex items-start justify-between gap-3">
            <div>
              <div class="smallcaps text-[11px] text-white/65">Fire Horse Card</div>
              <div id="resultHeadline" class="text-2xl font-semibold mt-1">‚Äî</div>
            </div>
            <div class="text-xs text-white/60 text-right">
              <div id="resultMetaTop">2026</div>
              <div id="resultMetaBottom">Ember ¬∑ Gold</div>
            </div>
          </div>

          <div id="resultBody" class="mt-4 text-white/80 leading-relaxed"></div>

          <div class="mt-5 border-t hairline pt-4 grid grid-cols-1 md:grid-cols-3 gap-3 text-sm">
            <div>
              <div class="smallcaps text-[11px] text-white/60">Lucky</div>
              <div id="luckyLine" class="mt-1 text-white/80">‚Äî</div>
            </div>
            <div>
              <div class="smallcaps text-[11px] text-white/60">Avoid</div>
              <div id="avoidLine" class="mt-1 text-white/80">‚Äî</div>
            </div>
            <div>
              <div class="smallcaps text-[11px] text-white/60">Directive</div>
              <div id="directiveLine" class="text-white/80">‚Äî</div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // ----------------------------
    // Data packs (edit freely)
    // ----------------------------
    const directives = [
      "Move first. Refine after.",
      "Heat reveals truth.",
      "Choose speed over perfection.",
      "Say less. Ship more.",
      "If it scares you, it‚Äôs probably correct.",
      "No more almost. Only done.",
      "Be bold. Be brief. Be gone.",
      "You don‚Äôt need permission. You need momentum.",
      "Stop negotiating with hesitation.",
      "Make it real ‚Äî then make it beautiful."
    ];

    const fortunes = [
      "A small risk becomes a large reward ‚Äî but only if you move this week.",
      "A new collaborator appears when you post the thing you‚Äôre overthinking.",
      "Your ‚Äòthrowaway‚Äô idea becomes someone else‚Äôs obsession.",
      "The Fire Horse favors bold launches and clean exits.",
      "You‚Äôll cut one distraction and gain ten hours of peace.",
      "You‚Äôll be underestimated ‚Äî which is exactly your advantage.",
      "Someone is about to match your energy. Don‚Äôt dim first.",
      "A lucky coincidence is just prepared momentum."
    ];

    // Simple zodiac mapping for convenience (you can expand copy live)
    const zodiacAnimals = [
      { animal: "Rat", years: [2020, 2008, 1996, 1984, 1972, 1960] },
      { animal: "Ox", years: [2021, 2009, 1997, 1985, 1973, 1961] },
      { animal: "Tiger", years: [2022, 2010, 1998, 1986, 1974, 1962] },
      { animal: "Rabbit", years: [2023, 2011, 1999, 1987, 1975, 1963] },
      { animal: "Dragon", years: [2024, 2012, 2000, 1988, 1976, 1964] },
      { animal: "Snake", years: [2025, 2013, 2001, 1989, 1977, 1965] },
      { animal: "Horse", years: [2026, 2014, 2002, 1990, 1978, 1966] },
      { animal: "Goat", years: [2027, 2015, 2003, 1991, 1979, 1967] },
      { animal: "Monkey", years: [2028, 2016, 2004, 1992, 1980, 1968] },
      { animal: "Rooster", years: [2029, 2017, 2005, 1993, 1969] },
      { animal: "Dog", years: [2030, 2018, 2006, 1994, 1982, 1970] },
      { animal: "Pig", years: [2031, 2019, 2007, 1995, 1983, 1971] },
    ];

    const zodiacVibes = {
      Rat: "Quick mind. Fire Horse year rewards decisive action, not anxious loops.",
      Ox: "Steady power. Fire Horse year asks you to sprint in short bursts.",
      Tiger: "Bold heart. Fire Horse year amplifies your leadership ‚Äî use it cleanly.",
      Rabbit: "Soft strength. Fire Horse year: protect peace, keep boundaries sharp.",
      Dragon: "Main character energy. Fire Horse year: pick one big thing and dominate it.",
      Snake: "Strategic elegance. Fire Horse year: stop waiting for perfect timing.",
      Horse: "You‚Äôre in your element. Fire Horse year: go fast, but don‚Äôt burn out.",
      Goat: "Creative intuition. Fire Horse year: structure your art so it ships.",
      Monkey: "Chaos genius. Fire Horse year: channel it into one finished product.",
      Rooster: "Precision + pride. Fire Horse year: publish before you polish.",
      Dog: "Loyal + direct. Fire Horse year: choose people who choose you back.",
      Pig: "Warm abundance. Fire Horse year: say no to energy vampires."
    };

    const exVerdicts = [
      { verdict: "NO.", body: "They miss the vibe, not the responsibility. Keep it moving." },
      { verdict: "YES‚Ä¶ but don‚Äôt clap.", body: "Fire Horse warning: they return for dopamine. Require devotion." },
      { verdict: "ONLY IF Mercury does parkour.", body: "Translation: it‚Äôs not happening. Add them to your ‚Äònever again‚Äô archive." },
      { verdict: "YES, briefly.", body: "A cameo. Not a season. Don‚Äôt give them the renewal contract." },
      { verdict: "NO (respectfully).", body: "You‚Äôre ahead of them now. That‚Äôs why it feels quiet." }
    ];

    const luckyColors = ["Ember Red", "Molten Gold", "Charcoal Black", "Cherry Lacquer"];
    const luckyNumbers = ["8", "18", "28", "88", "108", "3", "13"];
    const avoids = [
      "situationship math",
      "doom scrolling",
      "impulse spending (except couture)",
      "over-explaining",
      "shipping ‚Äòlater‚Äô",
      "people who say ‚Äútrust me‚Äù"
    ];

    // ----------------------------
    // Modes config
    // ----------------------------
    const modes = {
      fortune: {
        title: "Your Fortune",
        desc: "Click to reveal your Fire Horse fortune card.",
        inputs: () => `
          <div class="text-white/70 text-sm">
            Click <span class="text-white/90 font-medium">Reveal</span> to pull your fortune.
          </div>
        `,
        generate: () => {
          const fortune = pick(fortunes);
          return {
            headline: "Fortune pulled.",
            body: fortune,
            lucky: `${pick(luckyColors)} ¬∑ ${pick(luckyNumbers)}`,
            avoid: pick(avoids),
          };
        }
      },

      luck: {
        title: "Luck Index",
        desc: "Measure your luck aura. Fire Horse energy loves bold, clean moves.",
        inputs: () => `
          <div class="space-y-2">
            <label class="text-xs text-white/60 smallcaps">How chaotic are you right now?</label>
            <input id="chaos" type="range" min="0" max="100" value="55" class="w-full">
            <div class="flex justify-between text-xs text-white/55">
              <span>calm</span><span>unhinged</span>
            </div>
          </div>
          <div class="space-y-2">
            <label class="text-xs text-white/60 smallcaps">Focus</label>
            <select id="focus" class="w-full rounded-2xl bg-white/5 border hairline px-3 py-2 text-sm">
              <option value="money">Money</option>
              <option value="romance">Romance</option>
              <option value="career">Career</option>
            </select>
          </div>
        `,
        generate: () => {
          const chaos = clamp(parseInt(q("#chaos")?.value ?? "55", 10), 0, 100);
          const focus = q("#focus")?.value ?? "money";
          const base = Math.round((100 - Math.abs(55 - chaos)) * 0.92); // peak luck near 55 chaos (fun)
          const jitter = randInt(-10, 10);
          const score = clamp(base + jitter, 0, 100);

          const lines = {
            money: [
              "Your luck runs hot. Make one clean bet, not five messy ones.",
              "A small, fast launch beats a perfect, late masterpiece.",
              "Cut one expense. Redirect it into momentum."
            ],
            romance: [
              "High heat: you attract attention. Filter for seriousness.",
              "Don‚Äôt chase ‚Äî choose.",
              "Your softness is power. Your boundaries are luxury."
            ],
            career: [
              "Fire Horse favors decisive builders. Publish the work.",
              "One project. One sprint. One win.",
              "Say yes to visibility. No distraction."
            ]
          };

          return {
            headline: `Luck Score: ${score}/100`,
            body: pick(lines[focus]),
            lucky: `${pick(luckyColors)} ¬∑ ${pick(luckyNumbers)}`,
            avoid: score > 65 ? "hesitation" : "overcommitting",
          };
        }
      },

      zodiac: {
        title: "Zodiac Mirror",
        desc: "Enter your birth year for a quick, playful mirror (not that serious).",
        inputs: () => `
          <div class="space-y-2">
            <label class="text-xs text-white/60 smallcaps">Birth year</label>
            <input id="birthYear" inputmode="numeric" placeholder="e.g. 1996"
              class="w-full rounded-2xl bg-white/5 border hairline px-3 py-2 text-sm outline-none focus:ring-1 focus:ring-white/20">
            <div class="text-xs text-white/50">Tip: if you want, you can fake it on stream and pick any year üòå</div>
          </div>
        `,
        generate: () => {
          const year = parseInt(q("#birthYear")?.value ?? "", 10);
          const animal = isFinite(year) ? getZodiacAnimal(year) : pick(Object.keys(zodiacVibes));
          const vibe = zodiacVibes[animal] ?? "You‚Äôre mysterious. Fire Horse year says: move anyway.";

          return {
            headline: `You read as: ${animal}`,
            body: vibe,
            lucky: `${pick(luckyColors)} ¬∑ ${pick(luckyNumbers)}`,
            avoid: pick(avoids),
          };
        }
      },

      ex: {
        title: "Will Your Ex Come Back?",
        desc: "A chaotic Fire Horse check (for entertainment purposes only).",
        inputs: () => `
          <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
            ${yn("blocked", "Did you block them?")}
            ${yn("stories", "Do they watch your stories?")}
            ${yn("text", "Do they text ‚ÄúI‚Äôve been thinking‚Äù?")}
          </div>
        `,
        generate: () => {
          const blocked = q("#blocked")?.value ?? "no";
          const stories = q("#stories")?.value ?? "no";
          const text = q("#text")?.value ?? "no";

          // Lightweight ‚Äúlogic‚Äù + randomness
          let bias = 0;
          if (blocked === "yes") bias -= 2;
          if (stories === "yes") bias += 2;
          if (text === "yes") bias += 2;

          const roll = randInt(-2, 2) + bias;
          let pickSet = exVerdicts;

          if (roll >= 3) pickSet = exVerdicts.filter(v => v.verdict.startsWith("YES"));
          if (roll <= -1) pickSet = exVerdicts.filter(v => v.verdict.startsWith("NO"));

          const out = pick(pickSet.length ? pickSet : exVerdicts);

          return {
            headline: out.verdict,
            body: out.body,
            lucky: `Best reply: ‚ÄúWishing you well.‚Äù`,
            avoid: "late-night nostalgia",
          };
        }
      }
    };

    // ----------------------------
    // UI wiring
    // ----------------------------
    let currentMode = "fortune";

    const modeTitle = q("#modeTitle");
    const modeDesc = q("#modeDesc");
    const inputs = q("#inputs");
    const goBtn = q("#goBtn");

    const resultCard = q("#resultCard");
    const resultHeadline = q("#resultHeadline");
    const resultBody = q("#resultBody");
    const luckyLine = q("#luckyLine");
    const avoidLine = q("#avoidLine");
    const directiveLine = q("#directiveLine");

    function renderMode(modeKey) {
      currentMode = modeKey;
      // tabs
      qa(".tab").forEach(btn => btn.dataset.active = String(btn.dataset.mode === modeKey));
     // text
      modeTitle.textContent = modes[modeKey].title;
      modeDesc.textContent = modes[modeKey].desc;
      // inputs
      inputs.innerHTML = modes[modeKey].inputs();
      // hide old result until user reveals
    }

    function reveal() {
      const out = modes[currentMode].generate();
      resultHeadline.textContent = out.headline;
      resultBody.textContent = out.body;
      luckyLine.textContent = out.lucky;
      avoidLine.textContent = out.avoid;
      directiveLine.textContent = pick(directives);

      resultCard.classList.remove("hidden");
      resultCard.classList.remove("reveal");
      void resultCard.offsetWidth; // reflow to retrigger animation
      resultCard.classList.add("reveal");

      // Slight ember burst
      emberBurst();
    }

    qa(".tab").forEach(btn => btn.addEventListener("click", () => renderMode(btn.dataset.mode)));
    goBtn.addEventListener("click", reveal);

    q("#resetBtn").addEventListener("click", () => {
      resultCard.classList.add("hidden");
      // reset mode inputs quickly
      renderMode(currentMode);
    });

    q("#shareBtn").addEventListener("click", async () => {
      q("#shareHint").classList.remove("hidden");
      setTimeout(() => q("#shareHint").classList.add("hidden"), 1800);

      // If Web Share API exists, share the page URL
      if (navigator.share) {
        try {
          await navigator.share({
            title: "FIRE HORSE // 2026",
            text: "Pulled a Fire Horse card üî•üê¥",
            url: location.href
          });
        } catch {}
      }
    });

    // Dtive refresh
    q("#newDirectiveBtn").addEventListener("click", () => {
      q("#directive").textContent = pick(directives);
      emberBurst();
    });

    // Initial render
    renderMode("fortune");

    // ----------------------------
    // Helpers
    // ----------------------------
    function q(sel) { return document.querySelector(sel); }
    function qa(sel) { return Array.from(document.querySelectorAll(sel)); }
    function randInt(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }
    function pick(arr) { return arr[Math.floor(Math.random() * arr.length)]; }
    function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

    function yn(id, label){
      return `
        <div class="space-y-2">
          <label class="text-xs text-white/60 smallcaps">${label}</label>
          <select id="${id}" class="w-full rounded-2xl bg-white/5 border hairline px-3 py-2 text-sm">
            <option value="no">No</option>
            <option value="yes">Yes</option>
          </select>
        </div>
      `;
    }

    function getZodiacAnimal(year){
      // If year isn't in our small list, approximate by modulo cycle from 2026 Horse.
      for (const z of zodiacAnimals) if (z.years.includes(year)) return z.animal;

      const cycle = ["Rat","Ox","Tiger","Rabbit","Dragon","Snake","Horse","Goat","Monkey","Rooster","Dog","Pig"];
      // 2026 is Horse in our cycle index 6
      const baseYear = 2026;
      const baseIdx = 6;
      const diff = year - baseYear;
      const idx = (baseIdx + (diff % 12) + 12) % 12;
      return cycle[idx];
    }

    // ----------------------------
    // Embers canvas (lightweight luxury)
    // ----------------------------
    const canvas = q("#embers");
    const ctx = canvas.getContext("2d");
    let W = 0, H = 0;
    let particles = [];
    let burst = 0;

    function resize(){
      W = canvas.width = Math.floor(window.innerWidth * devicePixelRatio);
      H = canvas.height = Math.floor(window.innerHeight * devicePixelRatio);
    }
    window.addEventListener("resize", resize);
    resize();

    function spawnParticle(x = Math.random()*W, y = H + 20){
      const speed = (0.25 + Math.random()*0.9) * devicePixelRatio;
      return {
        x, y,
        vx: (Math.random() - 0.5) * 0.12 * devicePixelRatio,
        vy: -speed,
        r: (0.8 + Math.random()*2.4) * devicePixelRatio,
        a: 0.18 + Math.random()*0.35,
        life: 260 + Math.random()*220
      };
    }

    function emberBurst(){
      burst = 28;
    }

    function step(){
      ctx.clearRect(0,0,W,H);

      // add background drift
      if (particles.length < 140) particles.push(spawnParticle());

      // burst on reveal
      while (burst-- > 0) {
        particles.push(spawnParticle((W*0.55) + randInt(-140, 140)*devicePixelRatio, (H*0.55) + randInt(-60, 120)*devicePixelRatio));
      }
      burst = Math.max(burst, 0);

      // draw
      for (const p of particles) {
        p.x += p.vx;
        p.y += p.vy;
        p.vy *= 0.9992;
        p.life -= 1;

        // fade out near top
        const fade = clamp(p.y / (H * 0.7), 0, 1);
        const alpha = p.a * fade;

        // ember color blend
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
        ctx.fillStyle = `rgba(255, 90, 31, ${alpha})`;
        ctx.fill();

        // tiny gold highlight sometimes
        if (Math.random() < 0.02) {
          ctx.beginPath();
          ctx.arc(p.x + p.r*0.7, p.y - p.r*0.4, p.r*0.45, 0, Math.PI*2);
          ctx.fillStyle = `rgba(255, 196, 100, ${alpha*0.7})`;
          ctx.fill();
        }
      }

      // cull old
      particles = particles.filter(p => p.life > 0 && p.y > -30);

      requestAnimationFrame(step);
    }
    step();

    let lastShake = 0;
    window.addEventListener("devicemotion", (e) => {
      if (currentMode !== "fortune") return;
      const acc = e.accelerationIncludingGravity;
      if (!acc) return;
      const mag = Math.abs(acc.x||0) + Math.abs(acc.y||0) + Math.abs(acc.z||0);
      const now = Date.now();
      if (mag > 28 && now - lastShake > 900) {
        lastShake = now;
        reveal();
      }
    });
  </script>
</body>
</html>

